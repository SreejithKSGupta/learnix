<div class="forgot-password-container">
  <mat-card class="forgot-password-card">
    <mat-card-header>
      <h1 class="text-center">Forgot Password</h1>
    </mat-card-header>

    <!-- Step 1: Email Input -->
    <mat-card-content *ngIf="currentStep === 1">
      <form [formGroup]="forgotPasswordForm" (ngSubmit)="onEmailSubmit()" novalidate>
        <div class="form-group">
          <mat-form-field appearance="fill" class="full-width">
            <mat-label>Email Address</mat-label>
            <input matInput formControlName="email" type="email" />
            <mat-error *ngIf="forgotPasswordForm.get('email')?.hasError('required')">Email is required.</mat-error>
            <mat-error *ngIf="forgotPasswordForm.get('email')?.hasError('email')">Please enter a valid email address.</mat-error>
          </mat-form-field>
        </div>

        <button mat-flat-button color="primary" type="submit" class="full-width">Next</button>

        <div *ngIf="errorMessage" class="error-message mt-2">
          {{ errorMessage }}
        </div>
      </form>
    </mat-card-content>

    <!-- Step 2: OTP Verification -->
    <mat-card-content *ngIf="currentStep === 2">
      <form [formGroup]="otpForm" (ngSubmit)="onOtpSubmit()" novalidate>
        <div class="form-group">
          <mat-form-field appearance="fill" class="full-width">
            <mat-label>Enter OTP</mat-label>
            <input matInput formControlName="otp" type="text" />
            <mat-error *ngIf="otpForm.get('otp')?.hasError('required')">OTP is required.</mat-error>
            <mat-error *ngIf="otpForm.get('otp')?.hasError('pattern')">Invalid OTP. Please enter '1234'.</mat-error>
          </mat-form-field>
        </div>

        <button mat-flat-button color="primary" type="submit" class="full-width">Verify OTP</button>

        <div *ngIf="errorMessage" class="error-message mt-2">
          {{ errorMessage }}
        </div>
      </form>
    </mat-card-content>

    <!-- Step 3: Password Reset -->
    <mat-card-content *ngIf="currentStep === 3">
      <form [formGroup]="passwordResetForm" (ngSubmit)="onPasswordResetSubmit()" novalidate>
        <div class="form-group">
          <mat-form-field appearance="fill" class="full-width">
            <mat-label>New Password</mat-label>
            <input matInput formControlName="newPassword" type="password" />
            <mat-error *ngIf="passwordResetForm.get('newPassword')?.hasError('required')">New password is required.</mat-error>
            <mat-error *ngIf="passwordResetForm.get('newPassword')?.hasError('minlength')">Password must be at least 6 characters long.</mat-error>
          </mat-form-field>
        </div>

        <div class="form-group">
          <mat-form-field appearance="fill" class="full-width">
            <mat-label>Confirm Password</mat-label>
            <input matInput formControlName="confirmPassword" type="password" />
            <mat-error *ngIf="passwordResetForm.get('confirmPassword')?.hasError('required')">Confirm password is required.</mat-error>
            <mat-error *ngIf="passwordResetForm.hasError('mismatch')">Passwords do not match.</mat-error>
          </mat-form-field>
        </div>

        <button mat-flat-button color="primary" type="submit" class="full-width">Reset Password</button>

        <div *ngIf="errorMessage" class="error-message mt-2">
          {{ errorMessage }}
        </div>
        <div *ngIf="successMessage" class="success-message mt-2">
          {{ successMessage }}
        </div>
      </form>
    </mat-card-content>

  </mat-card>
</div>
